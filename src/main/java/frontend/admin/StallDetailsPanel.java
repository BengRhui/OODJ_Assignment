/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package frontend.admin;

import backend.entity.Stall;
import frontend.pop_up.SystemPopUp;
import java.awt.Color;

/**
 *
 * @author Chun Ming (TP068983), Beng Rhui (TP068495)
 */
public class StallDetailsPanel extends javax.swing.JPanel {

    private Stall currentStall;
    
    /**
     * Creates new form StallDetailsPanel
     */
    public StallDetailsPanel(Stall stall) {
        
        // Set the current stall
        currentStall = stall;
        
        // Render GUI components
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        stallIDField = new javax.swing.JLabel();
        stallNameScrollPane = new javax.swing.JScrollPane();
        stallNameField = new javax.swing.JTextArea();
        categoryScrollPane = new javax.swing.JScrollPane();
        categoryField = new javax.swing.JTextArea();
        editIcon = new javax.swing.JLabel();
        deleteIcon = new javax.swing.JLabel();

        setBackground(new java.awt.Color(227, 202, 165));
        setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 2, true));
        setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        stallIDField.setFont(new java.awt.Font("Arial", 1, 36)); // NOI18N
        stallIDField.setText(currentStall.getStallID());
        add(stallIDField, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 40, -1, -1));

        stallNameScrollPane.setBorder(null);
        stallNameScrollPane.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        stallNameScrollPane.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);
        stallNameScrollPane.setEnabled(false);

        stallNameField.setEditable(false);
        stallNameField.setBackground(new Color(227, 202, 165));
        stallNameField.setColumns(20);
        stallNameField.setFont(new java.awt.Font("Arial", 0, 24)); // NOI18N
        stallNameField.setRows(1);
        stallNameField.setText(currentStall.getStallName());
        stallNameField.setBorder(null);
        stallNameField.setCaretColor(new Color(227, 202, 165));
        stallNameScrollPane.setViewportView(stallNameField);

        add(stallNameScrollPane, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 90, 320, 40));

        categoryScrollPane.setBorder(null);
        categoryScrollPane.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        categoryScrollPane.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);

        categoryField.setBackground(new java.awt.Color(227, 202, 165));
        categoryField.setColumns(20);
        categoryField.setFont(new java.awt.Font("Arial", 0, 18)); // NOI18N
        categoryField.setRows(1);
        categoryField.setText("Category: " + currentStall.generateCategoryList());
        categoryField.setBorder(null);
        categoryScrollPane.setViewportView(categoryField);

        add(categoryScrollPane, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 140, 320, 30));

        editIcon.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        editIcon.setIcon(new javax.swing.ImageIcon(getClass().getResource("/asset/system/edit_icon.png"))); // NOI18N
        editIcon.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        editIcon.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                editIconMouseClicked(evt);
            }
        });
        add(editIcon, new org.netbeans.lib.awtextra.AbsoluteConstraints(260, 180, 50, 50));

        deleteIcon.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        deleteIcon.setIcon(new javax.swing.ImageIcon(getClass().getResource("/asset/system/delete_icon.png"))); // NOI18N
        deleteIcon.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        deleteIcon.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                deleteIconMouseClicked(evt);
            }
        });
        add(deleteIcon, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 180, 50, 50));
    }// </editor-fold>//GEN-END:initComponents

    private void deleteIconMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_deleteIconMouseClicked

        // Show a message for deletion confirmation
        SystemPopUp deleteMessage = new SystemPopUp(
                MainPage.currentFrame,
                "Confirm Delete",
                "Do you wish to delete the stall?",
                new String[]{"No", "Yes"}
        );
        deleteMessage.setVisible(true);
        
        // Get the status of the message
        int promptStatus = deleteMessage.getStatus();
        
        // Perform deletion if user choose yes
        if (promptStatus == 1) {
            
            // Retrieve the status after deletion
            int deleteStatus = currentStall.deleteStall();
            
            // Declare variable to store message string
            String errorMessage = null;
            
            // Generate different message based on the different error status
            switch (deleteStatus) {
                case 0 -> errorMessage = "There are still vendors associated with the stall. Please remove them from the stall before deleting.";
                case -1 -> errorMessage = "Items in the store could not be deleted. Please inspect code.";
                case -2 -> errorMessage = "Fail to switch stall attributes in orders to null. Please inspect code.";
                case -3 -> errorMessage = "Stall cannot be removed from the list. Please inspect code";
            }
            
            // If error message is set
            if (errorMessage != null) {
            
                // Display the error message
                SystemPopUp errorPopUpMessage = new SystemPopUp(
                        MainPage.currentFrame,
                        "Error",
                        errorMessage,
                        new String[]{"OK"}
                );
                errorPopUpMessage.setVisible(true);
                
            } else {
                
                // Display message to indicate successful deletion
                SystemPopUp successfulDeletionMessage = new SystemPopUp(
                        MainPage.currentFrame,
                        "Stall Deleted Successful",
                        "The store is deleted from the system successfully.",
                        new String[]{"OK"}
                );
                successfulDeletionMessage.setVisible(true);
            }
            
            // Update panel
            StallListPanel.updatePanel();
        }
    }//GEN-LAST:event_deleteIconMouseClicked

    private void editIconMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_editIconMouseClicked

        // Call the pop up to edit store
        StallInformationForm editStall = new StallInformationForm(currentStall);
        editStall.setVisible(true);
        editStall.setLocationRelativeTo(MainPage.currentFrame);
        
        // Disable current frame
        MainPage.currentFrame.setEnabled(false);
    }//GEN-LAST:event_editIconMouseClicked


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextArea categoryField;
    private javax.swing.JScrollPane categoryScrollPane;
    private javax.swing.JLabel deleteIcon;
    private javax.swing.JLabel editIcon;
    private javax.swing.JLabel stallIDField;
    private javax.swing.JTextArea stallNameField;
    private javax.swing.JScrollPane stallNameScrollPane;
    // End of variables declaration//GEN-END:variables
}
