/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package frontend.customer;

import backend.entity.Item;
import frontend.pop_up.SystemPopUp;

/**
 *
 * @author limbengrhui
 */
public class CartItemPanel extends javax.swing.JPanel {

    private Item currentItem;
    private int currentItemQuantity;
    
    /**
     * Creates new form CartItemPanel
     */
    public CartItemPanel(Item item, int quantity, boolean deletable) {

        // Initialize current item
        currentItem = item;
        currentItemQuantity = quantity;
        
        // Render GUI
        initComponents();
        
        // Remove deletable icon if deletable is false
        if (!deletable) remove(deleteIcon);
        
        // Refresh panels
        revalidate();
        repaint();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        itemNameScrollPane = new javax.swing.JScrollPane();
        itemNameField = new javax.swing.JTextArea();
        pricePerUnitField = new javax.swing.JLabel();
        quantityField = new javax.swing.JLabel();
        totalPriceField = new javax.swing.JLabel();
        deleteIcon = new javax.swing.JLabel();

        setBackground(new java.awt.Color(255, 251, 233));
        setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        itemNameScrollPane.setBackground(new java.awt.Color(255, 251, 233));
        itemNameScrollPane.setBorder(null);
        itemNameScrollPane.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        itemNameScrollPane.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);

        itemNameField.setEditable(false);
        itemNameField.setBackground(new java.awt.Color(255, 251, 233));
        itemNameField.setColumns(20);
        itemNameField.setFont(new java.awt.Font("Arial", 0, 18)); // NOI18N
        itemNameField.setRows(1);
        itemNameField.setText(currentItem.getItemName());
        itemNameField.setBorder(null);
        itemNameScrollPane.setViewportView(itemNameField);

        add(itemNameScrollPane, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 20, 260, 25));

        pricePerUnitField.setFont(new java.awt.Font("Arial", 0, 18)); // NOI18N
        pricePerUnitField.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        pricePerUnitField.setText(String.format("(RM%.2f)", currentItem.getPrice()));
        add(pricePerUnitField, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 40, 120, 30));

        quantityField.setFont(new java.awt.Font("Arial", 0, 18)); // NOI18N
        quantityField.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        quantityField.setText(String.valueOf(currentItemQuantity));
        add(quantityField, new org.netbeans.lib.awtextra.AbsoluteConstraints(260, 20, 80, 30));

        totalPriceField.setFont(new java.awt.Font("Arial", 0, 18)); // NOI18N
        totalPriceField.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        totalPriceField.setText(String.format("RM%.2f", currentItem.getPrice(currentItemQuantity)));
        add(totalPriceField, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 20, 120, 30));

        deleteIcon.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        deleteIcon.setIcon(new javax.swing.ImageIcon(getClass().getResource("/asset/system/delete_icon.png"))); // NOI18N
        deleteIcon.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        deleteIcon.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                deleteIconMouseClicked(evt);
            }
        });
        add(deleteIcon, new org.netbeans.lib.awtextra.AbsoluteConstraints(560, 10, 60, 60));
    }// </editor-fold>//GEN-END:initComponents

    private void deleteIconMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_deleteIconMouseClicked

        // Delete item from cart
        boolean deleteStatus = CartPopUp.getCustomer().removeItemFromCart(currentItem);
        
        // If the item fails to delete
        if (!deleteStatus) {
            
            // Create error message
            SystemPopUp errorMessage = new SystemPopUp(
                    CartPopUp.currentFrame,
                    "Error in Deletion",
                    "Error while deleting items. Please inspect code.",
                    new String[]{"OK"}
            );
            errorMessage.setVisible(true);
        }
        
        // Update panel
        CartPopUp.updateCartPanel();
    }//GEN-LAST:event_deleteIconMouseClicked


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel deleteIcon;
    private javax.swing.JTextArea itemNameField;
    private javax.swing.JScrollPane itemNameScrollPane;
    private javax.swing.JLabel pricePerUnitField;
    private javax.swing.JLabel quantityField;
    private javax.swing.JLabel totalPriceField;
    // End of variables declaration//GEN-END:variables
}
